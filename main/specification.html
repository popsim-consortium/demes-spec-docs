
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Specification &#8212; Demes Specification</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Gallery" href="gallery.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Demes Specification</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="tutorial.html">
   Tutorial
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gallery.html">
   Gallery
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Specification
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  demes-spec 0.9
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/specification.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/popsim-consortium/demes-spec"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/popsim-consortium/demes-spec/issues/new?title=Issue%20on%20page%20%2Fspecification.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/popsim-consortium/demes-spec/edit/main/docs/specification.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#note-to-readers">
   Note to Readers
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conventions-and-terminology">
   Conventions and Terminology
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#infinity">
     Infinity
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#population-genetics-model">
   Population genetics model
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#time">
     Time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#demes-ancestors-and-descendants">
     Demes, ancestors, and descendants
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#epochs-population-sizes-and-mating-systems">
     Epochs, population sizes, and mating systems
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#migrations">
     Migrations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#machine-data-model">
   Machine Data Model
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#common-concepts">
     Common concepts
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mdm-documents">
     MDM documents
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#deme">
     Deme
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#epoch">
     Epoch
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pulse">
     Pulse
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#migration">
     Migration
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#schema">
     Schema
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#human-data-model">
   Human Data Model
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#defaults">
     Defaults
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resolution">
     Resolution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sec-spec-hdm-schema">
     Schema
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="specification">
<span id="sec-spec"></span><h1>Specification<a class="headerlink" href="#specification" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Demes is a specification for describing population genetic models
of demographic history. This specification precisely defines the
population genetics model and its assumptions, along with
the data model used for interchange and the required behaviour
of implementations.</p>
<div class="admonition-who-is-this-specification-for admonition">
<p class="admonition-title">Who is this specification for?</p>
<p>This specification is intended to provide a detailed and definitive resource
for the following groups:</p>
<ul class="simple">
<li><p>Those implementing support for Demes as an input or output format in their programs</p></li>
<li><p>Those implementing a Demes parser</p></li>
</ul>
<p>As such, this specification contains a lot of detail that is not
interesting to most users.
If your wish to learn how to understand and create your own
Demes models, please see the <a class="reference internal" href="tutorial.html#sec-tutorial"><span class="std std-ref">Tutorial</span></a> instead.</p>
</div>
</div>
<div class="section" id="note-to-readers">
<h2>Note to Readers<a class="headerlink" href="#note-to-readers" title="Permalink to this headline">¶</a></h2>
<p>To provide feedback on this specification, please use the
<a class="reference external" href="https://github.com/popsim-consortium/demes-spec/issues">issue tracker</a>.</p>
</div>
<div class="section" id="conventions-and-terminology">
<span id="sec-spec-terminology"></span><h2>Conventions and Terminology<a class="headerlink" href="#conventions-and-terminology" title="Permalink to this headline">¶</a></h2>
<p>The term “Demes” in this document is to be interpreted as a
reference to this specification. A <a class="reference internal" href="#sec-spec-popgen-deme"><span class="std std-ref">Demes, ancestors, and descendants</span></a>
refers to a set of individuals that can be modelled by a fixed
set of parameters; to avoid confusion with name of the specification
we will usually use the term “population”, in the understanding that
the terms are equivalent for the purposes of this document.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Define the human and machine data models. And link to assumptions.</p>
</div>
<p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”,
“SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be
interpreted as described in <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc2119">RFC 2119</a>.</p>
<p>The terms “JSON”, “JSON text”, “JSON value”, “member”, “element”, “object”,
“array”, “number”, “string”, “boolean”, “true”, “false”, and “null” in this
document are to be interpreted as defined in
<a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8259">RFC 8259</a>.</p>
<p>The term “JSON Schema” in this document is to be interpreted as defined
in the JSON Schema
<a class="reference external" href="https://json-schema.org/draft/2020-12/json-schema-core.html">core specification</a>.</p>
<div class="section" id="infinity">
<span id="sec-spec-infinity"></span><h3>Infinity<a class="headerlink" href="#infinity" title="Permalink to this headline">¶</a></h3>
<p>JSON does not define an encoding for infinite-valued numbers.
However, infinite values are used in Demes for start times.
When <strong>writing</strong> a Demes model to a format that does not permit infinity,
such as JSON, the string “Infinity” must be used to encode infinity.
When writing to formats that do support infinity, such as YAML, the native
encoding for infinity should be used instead (<code class="docutils literal notranslate"><span class="pre">.inf</span></code> in YAML).
When <strong>reading</strong> a Demes model, the string “Infinity” must be decoded to mean
an infinite-valued number. When reading from formats that do support infinity,
the format’s native encoding for infinite-valued numbers must also be
supported.</p>
</div>
</div>
<div class="section" id="population-genetics-model">
<span id="sec-spec-popgen"></span><h2>Population genetics model<a class="headerlink" href="#population-genetics-model" title="Permalink to this headline">¶</a></h2>
<p>In this section we define the underlying population genetics assumptions made
in Demes and the key concepts involved. The goal is to provide a basic shared
vocabulary that is precise enough to make interchange of models defined in the
standard meaningful, but to avoid being overly proscriptive so that the format
is flexible enough to encompass a wide range of different methods. Issues
relating to the data model and interchange and dealt with in later sections.</p>
<p>In Demes, demographic models consist of one or more interacting populations (or
“demes”, to avoid confusion with the name of the specification itself).
Populations are defined as a collection of exchangeable individuals that exist
for a specified period of time, following a well-defined set of rules regarding
population sizes, mating systems, etc. Ancestor/descendant relationships
between populations can be defined, as well as continuous or instantaneous
migration between coexisting populations.</p>
<div class="section" id="time">
<span id="sec-spec-popgen-time"></span><h3>Time<a class="headerlink" href="#time" title="Permalink to this headline">¶</a></h3>
<p>Population and event times are written as units in the past, so that time zero
corresponds to the final generation or “now”, and event times in the past are
values greater than zero with larger values for events that occur in the more
distant past. While a natural specification for time units is in generations,
other time units are allowed, such as years. In the case that the time units
are not given in generations, the generation time must also be specified so
that times can be converted into generations. In general, as time flows from
the past to the present, populations, epochs, and migration events should be
specified in their order of appearance, so that their times are in descending
order.</p>
</div>
<div class="section" id="demes-ancestors-and-descendants">
<span id="sec-spec-popgen-deme"></span><h3>Demes, ancestors, and descendants<a class="headerlink" href="#demes-ancestors-and-descendants" title="Permalink to this headline">¶</a></h3>
<p>Models include one or more populations that have sizes greater than zero for
the duration of their existences, and population sizes are given as the number
of individuals. A population must exist for some duration of time greater than
zero, so that its start time must be larger than its end time. It may have one
or more ancestors, which are other populations that exist at the population’s
start time. If one ancestor is specified, the first generation is constructed
by randomly sampling parents from the ancestral population to contribute to
offspring in the newly generated population. If more than one ancestor is
specified, the proportions of ancestry from each contributing population must
be provided, and those proportions must sum to one. In this case, parents are
chosen randomly from each ancestral population with probability given by those
proportions. If no ancestors are specified, the population is assumed to have
start time equal to infinity, as individuals are not assumed to spontaneously
spring into existence.</p>
</div>
<div class="section" id="epochs-population-sizes-and-mating-systems">
<span id="sec-spec-popgen-epochs"></span><h3>Epochs, population sizes, and mating systems<a class="headerlink" href="#epochs-population-sizes-and-mating-systems" title="Permalink to this headline">¶</a></h3>
<p>Within populations, population sizes and mating systems are specified within
epochs. Epochs are non-overlapping intervals of time that cover the entire
existence interval of the population. Each epoch specifies the population size
over that interval, which can be a constant value or function defined by start
and end sizes that must remain positive.  If an epoch has a start time of
infinity, the population size for that epoch must be constant. Epochs can also
specify parameters for nonrandom mating, such as selfing or cloning rates,
which give the probability that offspring are generated from one generation to
the next by self-fertilisation or cloning of an individual. Selfing and cloning
rates take values between zero and one, and their sum must be less than one.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Selfing and cloning rate definitions may change.
See related issues
<a class="reference external" href="https://github.com/popsim-consortium/demes-spec/issues/33">here</a> and
<a class="reference external" href="https://github.com/popsim-consortium/demes-spec/issues/43">here</a>.</p>
</div>
</div>
<div class="section" id="migrations">
<span id="sec-spec-popgen-migration"></span><h3>Migrations<a class="headerlink" href="#migrations" title="Permalink to this headline">¶</a></h3>
<p>Finally, individuals in a population may have parents from a different
population through migrations. These can be defined as continuous migration
rates over time intervals for which populations coexist or through
instantaneous (or pulse) migration events at a given time. Continuous migration
rates are defined as the probability that parents in the “destination”
population are chosen from the “source” population.  Migration rates are thus
per generation and must be less than one. Furthermore, if more than one source
population have continuous migration into the same destination population, the
sum of those migration rates must also be less than one, as rates define
probabilities. The probability that parents come from the same population is
just one minus the sum of incoming migration rates. On the other hand, pulse
migration events specify the instantaneous replacement of a given fraction of
individuals in a destination population by individuals with parents from
a source population.  The fraction must be between zero and one, and if more
than one pulse occurs at the same time, those replacement events are applied
sequentially in the order that they are specified in the model.</p>
</div>
</div>
<div class="section" id="machine-data-model">
<span id="sec-spec-mdm"></span><h2>Machine Data Model<a class="headerlink" href="#machine-data-model" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The structure of the documentation here is still in flux - it’s not clear
how to split things up in terms of explaining what something is, and
also what the formal restrictions on its value are, particularly
in terms of the HDM and MDM split.</p>
</div>
<p>The Demes Machine Data Model (MDM) is a formal representation of the
<a class="reference internal" href="#sec-spec-popgen"><span class="std std-ref">Population genetics model</span></a> as a JSON document. The HDM is designed to be
used as input by programs such as population genetics simulators,
and explicitly includes all necessary details. The structure of JSON
documents conforming to the specification is formally defined
in the <a class="reference internal" href="#sec-spec-mdm-schema"><span class="std std-ref">Schema</span></a>, and the detailed requirements for each of the
elements in this data model are defined in this section.</p>
<div class="section" id="common-concepts">
<span id="sec-spec-defs-common"></span><h3>Common concepts<a class="headerlink" href="#common-concepts" title="Permalink to this headline">¶</a></h3>
<p>This section provides details on properties that occur in multiple
contexts.</p>
<dl class="simple myst">
<dt>start_time</dt><dd><p>The oldest time of a time interval (numerical upper bound).</p>
</dd>
<dt>end_time</dt><dd><p>The youngest time of a time interval (numerical lower bound).</p>
</dd>
</dl>
</div>
<div class="section" id="mdm-documents">
<h3>MDM documents<a class="headerlink" href="#mdm-documents" title="Permalink to this headline">¶</a></h3>
<p>The top-level MDM document describes a single instance of a Demes model.
Please see the <a class="reference internal" href="#sec-spec-popgen"><span class="std std-ref">Population genetics model</span></a> section for details about the
population genetics assumptions underlying these model descriptions.</p>
<p>Each MDM document contains the following list of properties. All
properties MUST be specified, and additional properties MUST NOT be
included in these documents. Please see the <a class="reference internal" href="#sec-spec-mdm-schema"><span class="std std-ref">Schema</span></a>
for definitive details on the types and structure of these properties.</p>
<dl class="simple myst">
<dt>description</dt><dd><p>A concise description of the demographic model.</p>
</dd>
<dt>doi</dt><dd><p>The DOI(s) of the publication(s) in which the model was inferred or
originally described.</p>
</dd>
<dt>time_units</dt><dd><p>The units of time used to specify times and time intervals. These
SHOULD be one of “generations” or “years”.</p>
</dd>
<dt>generation_time</dt><dd><p>The number by which times must be divided, to convert them to have
units of generations. Unless <code class="docutils literal notranslate"><span class="pre">time_units</span></code> are <code class="docutils literal notranslate"><span class="pre">generations</span></code>,
the <code class="docutils literal notranslate"><span class="pre">generation_time</span></code> MUST be specified.</p>
</dd>
<dt>demes</dt><dd><p>The list of demes in the model. At least one deme MUST be specified.
Please see the section <a class="reference internal" href="#sec-spec-mdm-deme"><span class="std std-ref">below</span></a> for the
required properties of these objects.</p>
</dd>
<dt>pulses</dt><dd><p>The list of pulses in the model.
Please see the section <a class="reference internal" href="#sec-spec-mdm-pulse"><span class="std std-ref">below</span></a> for the
required properties of these objects.</p>
</dd>
<dt>migrations</dt><dd><p>The list of migrations in the model.
Please see the section <a class="reference internal" href="#sec-spec-mdm-migration"><span class="std std-ref">below</span></a> for the
required properties of these objects.</p>
</dd>
</dl>
</div>
<div class="section" id="deme">
<span id="sec-spec-mdm-deme"></span><h3>Deme<a class="headerlink" href="#deme" title="Permalink to this headline">¶</a></h3>
<p>The deme may be a descendant of one or more demes in the graph, and may
be an ancestor to others. The deme exists over the half-open time interval
<code class="docutils literal notranslate"><span class="pre">(start_time,</span> <span class="pre">end_time]</span></code>, and it may continue to exist after
contributing ancestry to a descendant deme. The deme’s <code class="docutils literal notranslate"><span class="pre">end_time</span></code> is
defined as the <code class="docutils literal notranslate"><span class="pre">end_time</span></code> of the deme’s last epoch.</p>
<dl class="simple myst">
<dt>name</dt><dd><p>A string identifier for a deme, which MUST be unique among all demes in a document.
Must be a valid
<a class="reference external" href="https://docs.python.org/3/reference/lexical_analysis.html#identifiers">python identifier</a></p>
</dd>
<dt>description</dt><dd><p>A concise description of the deme.</p>
</dd>
<dt>ancestors</dt><dd><p>The ancestors of the deme at the start of the deme’s first epoch.
May be omitted if the deme has no ancestors in the graph.
If two or more ancestors are specified, the <code class="docutils literal notranslate"><span class="pre">proportions</span></code>
must also be specified, and the <code class="docutils literal notranslate"><span class="pre">start_time</span></code> must be defined
(either specified directly, or indirectly in the deme’s first epoch).
Each ancestor must be in the graph, and each ancestor must be
specified only once. A deme must not be one of its own ancestors.</p>
</dd>
<dt>proportions</dt><dd><p>The proportions of ancestry derived from each of the <code class="docutils literal notranslate"><span class="pre">ancestors</span></code>
at the start of the deme’s first epoch.
The <code class="docutils literal notranslate"><span class="pre">proportions</span></code> may be omitted if there are no ancestors, or if
there is only one ancestor.
The <code class="docutils literal notranslate"><span class="pre">proportions</span></code> must be ordered to correspond with the
order of <code class="docutils literal notranslate"><span class="pre">ancestors</span></code>. The proportions must sum to 1 (within a
reasonable tolerance, e.g. 1e-9).</p>
</dd>
<dt>start_time</dt><dd><p>The most ancient time at which the deme exists, in <code class="docutils literal notranslate"><span class="pre">time_units</span></code>
before the present. Demes with no ancestors are root demes and must
have an infinite <code class="docutils literal notranslate"><span class="pre">start_time</span></code>. Otherwise, the <code class="docutils literal notranslate"><span class="pre">start_time</span></code> must
correspond with the interval of existence
for each of the deme’s <code class="docutils literal notranslate"><span class="pre">ancestors</span></code>. I.e. the <code class="docutils literal notranslate"><span class="pre">start_time</span></code> must
be within the half-open interval <code class="docutils literal notranslate"><span class="pre">(deme.start_time,</span> <span class="pre">deme.end_time]</span></code>
for each deme in <code class="docutils literal notranslate"><span class="pre">ancestors</span></code>.</p>
</dd>
<dt>epochs</dt><dd><p>The list of epochs for this deme. There MUST be at least one epoch.
Please see the section <a class="reference internal" href="#sec-spec-mdm-epoch"><span class="std std-ref">below</span></a> for details.</p>
</dd>
</dl>
</div>
<div class="section" id="epoch">
<span id="sec-spec-mdm-epoch"></span><h3>Epoch<a class="headerlink" href="#epoch" title="Permalink to this headline">¶</a></h3>
<p>A deme-specific period of time spanning the half-open interval
<code class="docutils literal notranslate"><span class="pre">(start_time,</span> <span class="pre">end_time]</span></code>, in which a fixed set of population parameters
apply. The epoch’s <code class="docutils literal notranslate"><span class="pre">start_time</span></code> is defined as the <code class="docutils literal notranslate"><span class="pre">end_time</span></code> of the
previous epoch, or the deme’s <code class="docutils literal notranslate"><span class="pre">start_time</span></code> if it is the first epoch.</p>
<dl class="simple myst">
<dt>end_time</dt><dd><p>The most recent time of the epoch, in <code class="docutils literal notranslate"><span class="pre">time_units</span></code> before the present.</p>
</dd>
<dt>start_size</dt><dd><p>The population size at the epoch’s <code class="docutils literal notranslate"><span class="pre">start_time</span></code>.</p>
</dd>
<dt>end_size</dt><dd><p>The population size at the epoch’s <code class="docutils literal notranslate"><span class="pre">end_time</span></code>.</p>
</dd>
<dt>size_function</dt><dd><p>A function describing the population size change between
<code class="docutils literal notranslate"><span class="pre">start_time</span></code> and <code class="docutils literal notranslate"><span class="pre">end_time</span></code>. FIXME, MORE DETAIL.</p>
</dd>
<dt>cloning_rate</dt><dd><p>DEFINE ME</p>
</dd>
<dt>selfing_rate</dt><dd><p>DEFINE ME</p>
</dd>
</dl>
</div>
<div class="section" id="pulse">
<span id="sec-spec-mdm-pulse"></span><h3>Pulse<a class="headerlink" href="#pulse" title="Permalink to this headline">¶</a></h3>
<p>An instantaneous pulse of migration at <code class="docutils literal notranslate"><span class="pre">time</span></code>, from a list of source demes
(<code class="docutils literal notranslate"><span class="pre">sources</span></code>) into the <code class="docutils literal notranslate"><span class="pre">dest</span></code> deme.</p>
<dl class="simple myst">
<dt>sources</dt><dd><p>The list of deme IDs of the migration sources.</p>
</dd>
<dt>dest</dt><dd><p>The deme ID of the migration destination.</p>
</dd>
<dt>time</dt><dd><p>The time of migration, in <code class="docutils literal notranslate"><span class="pre">time_units</span></code> before the present.
The <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">dest</span></code> demes must both exist at the given
<code class="docutils literal notranslate"><span class="pre">time</span></code>.  I.e. <code class="docutils literal notranslate"><span class="pre">time</span></code> must be contained in the
<code class="docutils literal notranslate"><span class="pre">(deme.start_time,</span> <span class="pre">deme.end_time]</span></code> interval of the <code class="docutils literal notranslate"><span class="pre">source</span></code>
deme and the <code class="docutils literal notranslate"><span class="pre">dest</span></code> deme.</p>
</dd>
<dt>proportions</dt><dd><p>The proportions of ancestry in the <code class="docutils literal notranslate"><span class="pre">dest</span></code> deme derived from the demes
in <code class="docutils literal notranslate"><span class="pre">sources</span></code> immediately after the <code class="docutils literal notranslate"><span class="pre">time</span></code> of migration.
The <code class="docutils literal notranslate"><span class="pre">proportions</span></code> must be ordered to correspond with the order of
<code class="docutils literal notranslate"><span class="pre">sources</span></code>. The proportions must sum to less than or equal to 1
(within a reasonable tolerance, e.g. 1e-9).</p>
</dd>
</dl>
</div>
<div class="section" id="migration">
<span id="sec-spec-mdm-migration"></span><h3>Migration<a class="headerlink" href="#migration" title="Permalink to this headline">¶</a></h3>
<p>Continuous migration over the half-open time interval <code class="docutils literal notranslate"><span class="pre">(start_time,</span> <span class="pre">end_time]</span></code>.
If <code class="docutils literal notranslate"><span class="pre">demes</span></code> is specified, then migration shall be symmetric between all
pairs of demes with deme IDs in the array. If <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">dest</span></code> are
specified instead, migration shall be asymmetric from the deme with ID
<code class="docutils literal notranslate"><span class="pre">source</span></code> to the deme with ID <code class="docutils literal notranslate"><span class="pre">dest</span></code>. Either <code class="docutils literal notranslate"><span class="pre">demes</span></code>, or alternately
both <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">dest</span></code>, must be specified. If <code class="docutils literal notranslate"><span class="pre">demes</span></code> is specified,
neither <code class="docutils literal notranslate"><span class="pre">source</span></code> nor <code class="docutils literal notranslate"><span class="pre">dest</span></code> may be specified.</p>
<dl class="simple myst">
<dt>demes</dt><dd><p>The deme IDs of the symmetrically migrating demes.</p>
</dd>
<dt>source</dt><dd><p>The deme ID of the asymmetric migration source.</p>
</dd>
<dt>dest</dt><dd><p>The deme ID of the asymmetric migration destination.</p>
</dd>
<dt>start_time</dt><dd><p>The time at which migration begins, in <code class="docutils literal notranslate"><span class="pre">time_units</span></code> before the present.
The <code class="docutils literal notranslate"><span class="pre">start_time</span></code> must be contained in the
<code class="docutils literal notranslate"><span class="pre">[deme.start_time,</span> <span class="pre">deme.end_time)</span></code> interval of the <code class="docutils literal notranslate"><span class="pre">source</span></code> deme
and the <code class="docutils literal notranslate"><span class="pre">dest</span></code> deme.
If not specified, the migration <code class="docutils literal notranslate"><span class="pre">start_time</span></code> shall be the minimum
<code class="docutils literal notranslate"><span class="pre">deme.start_time</span></code> of the <code class="docutils literal notranslate"><span class="pre">source</span></code> deme and the <code class="docutils literal notranslate"><span class="pre">dest</span></code> deme.</p>
</dd>
<dt>end_time</dt><dd><p>The time at which migration stops, in <code class="docutils literal notranslate"><span class="pre">time_units</span></code> before the present.
The <code class="docutils literal notranslate"><span class="pre">end_time</span></code> must be contained in the
<code class="docutils literal notranslate"><span class="pre">(deme.start_time,</span> <span class="pre">deme.end_time]</span></code> interval of the <code class="docutils literal notranslate"><span class="pre">source</span></code> deme
and the <code class="docutils literal notranslate"><span class="pre">dest</span></code> deme.
If not specified, the migration <code class="docutils literal notranslate"><span class="pre">end_time</span></code> shall be the maximum
<code class="docutils literal notranslate"><span class="pre">deme.end_time</span></code> of the <code class="docutils literal notranslate"><span class="pre">source</span></code> deme and the <code class="docutils literal notranslate"><span class="pre">dest</span></code> deme.</p>
</dd>
<dt>rate</dt><dd><p>The rate of migration per generation.</p>
</dd>
</dl>
</div>
<div class="section" id="schema">
<span id="sec-spec-mdm-schema"></span><h3>Schema<a class="headerlink" href="#schema" title="Permalink to this headline">¶</a></h3>
<p>The schema listed here is definitive in terms of types and the
structure of the JSON documents that are considered to be
valid instances of the MDM</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">$schema</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http://json-schema.org/draft-07/schema#</span>
<span class="nt">title</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Fully qualified Demes graph</span>
<span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="nt">additionalProperties</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">properties</span><span class="p">:</span>
  <span class="nt">description</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;string&quot;</span>
  <span class="nt">doi</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>

  <span class="nt">time_units</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="c1"># TODO: shouldn&#39;t this be an enum?</span>

  <span class="nt">generation_time</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;number&quot;</span>
    <span class="nt">exclusiveMinimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>

  <span class="nt">demes</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="nt">minItems</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/deme&#39;</span>

  <span class="nt">pulses</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/pulse&#39;</span>

  <span class="nt">migrations</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/migration&#39;</span>

<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">description</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">doi</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">time_units</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">demes</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">generation_time</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">pulses</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">migrations</span>

<span class="nt">definitions</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>

  <span class="nt">rate</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="nt">minimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class="nt">maximum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>

  <span class="nt">proportion</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="nt">exclusiveMinimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class="nt">maximum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>

  <span class="nt">size</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="nt">exclusiveMinimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>

  <span class="nt">start_time</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
        <span class="nt">exclusiveMinimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
      <span class="p p-Indicator">-</span> <span class="nt">const</span><span class="p">:</span> <span class="s">&quot;Infinity&quot;</span>

  <span class="nt">end_time</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="nt">minimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>

  <span class="nt">epoch</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">end_time</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/end_time&#39;</span>
      <span class="nt">start_size</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/size&#39;</span>
      <span class="nt">end_size</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/size&#39;</span>
      <span class="nt">size_function</span><span class="p">:</span>
        <span class="c1"># TODO: make this an enumeration</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">cloning_rate</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/rate&#39;</span>
      <span class="nt">selfing_rate</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/rate&#39;</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">end_time</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">start_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">end_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">size_function</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cloning_rate</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">selfing_rate</span>

  <span class="nt">deme</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/name&#39;</span>
      <span class="nt">description</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;string&quot;</span>
      <span class="nt">ancestors</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
        <span class="nt">items</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/name&#39;</span>
      <span class="nt">proportions</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
        <span class="nt">items</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/proportion&#39;</span>
      <span class="nt">start_time</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/start_time&#39;</span>
      <span class="nt">epochs</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
        <span class="nt">minItems</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
        <span class="nt">items</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/epoch&#39;</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">description</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ancestors</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">proportions</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">start_time</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">epochs</span>

  <span class="nt">pulse</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">sources</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
        <span class="nt">items</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/name&#39;</span>
      <span class="nt">dest</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/name&#39;</span>
      <span class="nt">time</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
        <span class="nt">exclusiveMinimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
      <span class="nt">proportions</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
        <span class="nt">items</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/proportion&#39;</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sources</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">dest</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">time</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">proportions</span>

  <span class="nt">migration</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
      <span class="c1"># Asymmetric</span>
      <span class="nt">additionalProperties</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
      <span class="nt">properties</span><span class="p">:</span>
        <span class="nt">source</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/name&#39;</span>
        <span class="nt">dest</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/name&#39;</span>
        <span class="nt">start_time</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/start_time&#39;</span>
        <span class="nt">end_time</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/end_time&#39;</span>
        <span class="nt">rate</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/rate&#39;</span>
      <span class="nt">required</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">source</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">dest</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">start_time</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">end_time</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">rate</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
      <span class="nt">additionalProperties</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
      <span class="c1"># Symmetric</span>
      <span class="nt">properties</span><span class="p">:</span>
        <span class="nt">demes</span><span class="p">:</span>
          <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
          <span class="nt">items</span><span class="p">:</span>
            <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/name&#39;</span>
          <span class="nt">minItems</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
        <span class="nt">start_time</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/start_time&#39;</span>
        <span class="nt">end_time</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/end_time&#39;</span>
        <span class="nt">rate</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/rate&#39;</span>
      <span class="nt">required</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">demes</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">start_time</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">end_time</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">rate</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="human-data-model">
<span id="sec-spec-hdm"></span><h2>Human Data Model<a class="headerlink" href="#human-data-model" title="Permalink to this headline">¶</a></h2>
<p>The Demes Human Data Model (HDM) is an extension of the <a class="reference internal" href="#sec-spec-mdm"><span class="std std-ref">Machine Data Model</span></a>
that is designed for human readability. The HDM provides default values
for many parameters, removes redundant information in the MDM via rules described
in this section and also provides a default value replacement mechanism.
JSON documents conforming to the HDM are intended to be processed by a parser,
which outputs the corresponding MDM document.</p>
<p>This section defines the structure of HDM documents, the rules by
which they are transformed into MDM documents, and the error conditions
that should be detected by parsers.</p>
<div class="section" id="defaults">
<span id="sec-spec-hdm-defaults"></span><h3>Defaults<a class="headerlink" href="#defaults" title="Permalink to this headline">¶</a></h3>
<p>Repeated values such as shared population sizes represent a significant opportunity
for error in human-generated models. The HDM provides the default value
propagation mechanism to avoid this repetition.</p>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>Describe the process of hierarchical default value replacement.</p>
</div>
</div>
<div class="section" id="resolution">
<h3>Resolution<a class="headerlink" href="#resolution" title="Permalink to this headline">¶</a></h3>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p>Tidy this up - just putting text in here for the moment that’s
pulled from other parts of the document.</p>
</div>
<dl class="simple myst">
<dt>start_time</dt><dd><p>The most ancient time at which the deme exists, in <code class="docutils literal notranslate"><span class="pre">time_units</span></code>
before the present. Demes with no ancestors are root demes and must
have an infinite <code class="docutils literal notranslate"><span class="pre">start_time</span></code>. Otherwise, the <code class="docutils literal notranslate"><span class="pre">start_time</span></code> must
correspond with the interval of existence
for each of the deme’s <code class="docutils literal notranslate"><span class="pre">ancestors</span></code>. I.e. the <code class="docutils literal notranslate"><span class="pre">start_time</span></code> must
be within the half-open interval <code class="docutils literal notranslate"><span class="pre">(deme.start_time,</span> <span class="pre">deme.end_time]</span></code>
for each deme in <code class="docutils literal notranslate"><span class="pre">ancestors</span></code>.</p>
<p>If not specified, the deme’s <code class="docutils literal notranslate"><span class="pre">start_time</span></code> shall be obtained
according to the following rules (the first matching rule shall
be used).</p>
<ul class="simple">
<li><p>If the deme has one ancestor, and the ancestor has an
<code class="docutils literal notranslate"><span class="pre">end_time</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>, the ancestor’s <code class="docutils literal notranslate"><span class="pre">end_time</span></code> value shall be
used.</p></li>
<li><p>If the deme has no ancestors, the <code class="docutils literal notranslate"><span class="pre">start_time</span></code> shall be
infinitely far into the past. I.e. the <code class="docutils literal notranslate"><span class="pre">start_time</span></code> shall
have the value <code class="docutils literal notranslate"><span class="pre">infinity</span></code>.</p></li>
</ul>
<p>If the <code class="docutils literal notranslate"><span class="pre">start_time</span></code> has not been defined after following the
rules above, an error shall be raised. E.g. an error shall be
raised for the following conditions.</p>
<ul class="simple">
<li><p>If the deme has multiple ancestors,
and the deme’s <code class="docutils literal notranslate"><span class="pre">start_time</span></code> is not specified.</p></li>
<li><p>If the deme has one ancestor with an <code class="docutils literal notranslate"><span class="pre">end_time</span> <span class="pre">==</span> <span class="pre">0</span></code>,
and the deme’s <code class="docutils literal notranslate"><span class="pre">start_time</span></code> is not specified.</p></li>
<li><p>If the deme has zero ancestors and a finite <code class="docutils literal notranslate"><span class="pre">start_time</span></code>.</p></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="sec-spec-hdm-schema">
<span id="id4"></span><h3>Schema<a class="headerlink" href="#sec-spec-hdm-schema" title="Permalink to this headline">¶</a></h3>
<p>The schema listed here is definitive in terms of types and the
structure of the JSON documents that are considered to be
valid instances of the Demes standard.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">$schema</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http://json-schema.org/draft-07/schema#</span>
<span class="nt">title</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Demes graph</span>
<span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="nt">additionalProperties</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">properties</span><span class="p">:</span>
  <span class="nt">description</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;string&quot;</span>
    <span class="nt">default</span><span class="p">:</span> <span class="s">&quot;&quot;</span>
  <span class="nt">doi</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">default</span><span class="p">:</span> <span class="p p-Indicator">[]</span>

  <span class="nt">time_units</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="c1"># TODO: shouldn&#39;t this be an enum?</span>

  <span class="nt">generation_time</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;number&quot;</span>
    <span class="nt">exclusiveMinimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>

  <span class="nt">defaults</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
    <span class="nt">default</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">epoch</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/epoch&#39;</span>
      <span class="nt">migration</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/migration&#39;</span>
      <span class="nt">pulse</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/pulse&#39;</span>
      <span class="nt">deme</span><span class="p">:</span>
        <span class="nt">properties</span><span class="p">:</span>
          <span class="nt">description</span><span class="p">:</span>
            <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;string&quot;</span>
          <span class="nt">ancestors</span><span class="p">:</span>
            <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
            <span class="nt">items</span><span class="p">:</span>
              <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/name&#39;</span>
          <span class="nt">proportions</span><span class="p">:</span>
            <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
            <span class="nt">items</span><span class="p">:</span>
              <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/proportion&#39;</span>
          <span class="nt">start_time</span><span class="p">:</span>
            <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/start_time&#39;</span>

  <span class="nt">demes</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="nt">minItems</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/deme&#39;</span>

  <span class="nt">pulses</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/pulse&#39;</span>
    <span class="nt">default</span><span class="p">:</span> <span class="p p-Indicator">[]</span>

  <span class="nt">migrations</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/migration&#39;</span>
    <span class="nt">default</span><span class="p">:</span> <span class="p p-Indicator">[]</span>

<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">time_units</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">demes</span>

<span class="nt">definitions</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>

  <span class="nt">rate</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="nt">minimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class="nt">maximum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>

  <span class="nt">proportion</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="nt">exclusiveMinimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class="nt">maximum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>

  <span class="nt">size</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="nt">exclusiveMinimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>

  <span class="nt">start_time</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
        <span class="nt">exclusiveMinimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
      <span class="p p-Indicator">-</span> <span class="nt">const</span><span class="p">:</span> <span class="s">&quot;Infinity&quot;</span>

  <span class="nt">end_time</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="nt">minimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>

  <span class="nt">epoch</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">end_time</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/end_time&#39;</span>
      <span class="nt">start_size</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/size&#39;</span>
      <span class="nt">end_size</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/size&#39;</span>
      <span class="nt">size_function</span><span class="p">:</span>
        <span class="c1"># TODO: make this an enumeration</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
        <span class="nt">default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">exponential</span>
      <span class="nt">cloning_rate</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/rate&#39;</span>
      <span class="nt">selfing_rate</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/rate&#39;</span>

  <span class="nt">deme</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/name&#39;</span>
      <span class="nt">description</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;string&quot;</span>
        <span class="nt">default</span><span class="p">:</span> <span class="s">&quot;&quot;</span>
      <span class="nt">ancestors</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
        <span class="nt">items</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/name&#39;</span>
        <span class="nt">default</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
      <span class="nt">proportions</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
        <span class="nt">items</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/proportion&#39;</span>
      <span class="nt">start_time</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/start_time&#39;</span>
      <span class="nt">epochs</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
        <span class="nt">default</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
        <span class="nt">minItems</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
        <span class="nt">items</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/epoch&#39;</span>
      <span class="nt">defaults</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
        <span class="nt">default</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
        <span class="nt">additionalProperties</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="nt">properties</span><span class="p">:</span>
          <span class="nt">epoch</span><span class="p">:</span>
            <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/epoch&#39;</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span>

  <span class="nt">pulse</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">sources</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
        <span class="nt">items</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/name&#39;</span>
      <span class="nt">dest</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/name&#39;</span>
      <span class="nt">time</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
        <span class="nt">exclusiveMinimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
      <span class="nt">proportions</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
        <span class="nt">items</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/proportion&#39;</span>

  <span class="nt">migration</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">demes</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
        <span class="nt">items</span><span class="p">:</span>
          <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/name&#39;</span>
        <span class="nt">minItems</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
      <span class="nt">source</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/name&#39;</span>
      <span class="nt">dest</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/name&#39;</span>
      <span class="nt">start_time</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/start_time&#39;</span>
      <span class="nt">end_time</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/end_time&#39;</span>
      <span class="nt">rate</span><span class="p">:</span>
        <span class="nt">$ref</span><span class="p">:</span> <span class="s">&#39;#/definitions/rate&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="gallery.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Gallery</p>
        </div>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By PopSim Consortium<br/>
        
            &copy; Copyright 2021.<br/>
          <div class="extra_footer">
            demes-spec 0.9
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>