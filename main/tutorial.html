
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tutorial &#8212; Demes Specification</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Gallery" href="gallery.html" />
    <link rel="prev" title="Introduction" href="introduction.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      <h1 class="site-logo" id="site-title">Demes Specification</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Tutorial
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gallery.html">
   Gallery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="specification.html">
   Specification
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  demes-spec 0.9
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/tutorial.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/tutorial.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/popsim-consortium/demes-spec"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/popsim-consortium/demes-spec/issues/new?title=Issue%20on%20page%20%2Ftutorial.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/popsim-consortium/demes-spec/edit/main/docs/tutorial.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#yaml">
   YAML
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#terminology">
   Terminology
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-a-deme">
   What is a deme?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#default-values">
     Default values
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-an-epoch">
   What is an epoch?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#why-don-t-epochs-have-a-start-time-too">
     Why don’t epochs have a
     <code class="docutils literal notranslate">
      <span class="pre">
       start_time
      </span>
     </code>
     too?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exponential-size-changes">
   Exponential size changes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-demes">
   Multiple demes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-split-event">
     A split event
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-branch-event">
     A branch event
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-ancestors">
   Multiple ancestors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#continuous-migration">
   Continuous migration
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#asymmetric-migration">
     Asymmetric migration
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#symmetric-migration">
     Symmetric migration
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-pulse-of-admixture">
   A pulse of admixture
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setting-defaults">
   Setting defaults
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#time-units-and-generation-time">
   Time units and generation time
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#selfing-and-cloning">
   Selfing and cloning
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="tutorial">
<span id="sec-tutorial"></span><h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<div class="section" id="yaml">
<h2>YAML<a class="headerlink" href="#yaml" title="Permalink to this headline">¶</a></h2>
<p>A Demes model is written as a <a class="reference external" href="https://en.wikipedia.org/wiki/YAML">YAML</a> file.
A YAML file contains <code class="docutils literal notranslate"><span class="pre">property:</span> <span class="pre">value</span></code> pairs, and Demes imposes restrictions
by allowing only properties with specific names, which have specific types
of values.
YAML files have the extension <code class="docutils literal notranslate"><span class="pre">.yaml</span></code>, or sometimes <code class="docutils literal notranslate"><span class="pre">.yml</span></code>.
Don’t worry if you’ve never heard of YAML before, as the details of YAML
aren’t particularly important.
The example below gives an indication of what a Demes file looks like,
but we’ll explain each component gradually using additional examples.
For now, select the “Drawing” tab to see a diagramatic overview
of the demographic model.</p>
<p>{{ example.replace(“LABEL”, “01”) }}</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Demes specification defines a data model, not the YAML format itself.
A demographic model that uses the Demes data model can be easily converted
to any desired data-serialisation language.</p>
</div>
</div>
<div class="section" id="terminology">
<h2>Terminology<a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h2>
<p>We use the word “Demes” with a capital D to refer to the Demes data model or
the Demes specification, and “deme” or “demes” with a lowercase d when we
refer to a collection of individuals (a deme) or a property in the Demes
data model.</p>
</div>
<div class="section" id="what-is-a-deme">
<h2>What is a deme?<a class="headerlink" href="#what-is-a-deme" title="Permalink to this headline">¶</a></h2>
<p>A deme is a collection of individuals that share a set of population
parameters at any given time. Consider the simplest population model:
a single deme with constant population size.</p>
<p>{{ example.replace(“LABEL”, “02”).replace(“%DRAWING_TAG”, “:selected:”) }}</p>
<p>This deme exists now (zero generations ago), and also exists as far back
in time as we’re interested in looking (towards infinity generations ago).
In Demes, we say that the deme has an infinite <code class="docutils literal notranslate"><span class="pre">start_time</span></code>.
Select the “YAML” tab above the drawing to see how this model was implemented.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In YAML, infinity is spelled <code class="docutils literal notranslate"><span class="pre">.inf</span></code>, not <code class="docutils literal notranslate"><span class="pre">inf</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Each Demes model must define at least one deme with an infinte <code class="docutils literal notranslate"><span class="pre">start_time</span></code>.</p>
</div>
<div class="section" id="default-values">
<h3>Default values<a class="headerlink" href="#default-values" title="Permalink to this headline">¶</a></h3>
<p>Having a deme’s <code class="docutils literal notranslate"><span class="pre">start_time</span></code> property be infinite is very common.
So for demes without ancestors, the <code class="docutils literal notranslate"><span class="pre">start_time</span></code> may be omitted,
and will default to <code class="docutils literal notranslate"><span class="pre">.inf</span></code>. Similarly, the <code class="docutils literal notranslate"><span class="pre">end_time</span></code> property of
the final epoch may be omitted, and will default to <code class="docutils literal notranslate"><span class="pre">0</span></code>.
The following Demes file describes an equivalent model.</p>
<p>{{ example.replace(“LABEL”, “03”) }}</p>
</div>
</div>
<div class="section" id="what-is-an-epoch">
<h2>What is an epoch?<a class="headerlink" href="#what-is-an-epoch" title="Permalink to this headline">¶</a></h2>
<p>We partition a deme’s interval of existence into distinct <code class="docutils literal notranslate"><span class="pre">epochs</span></code>.
A deme always has at least one epoch. The population parameters for a
deme are allowed to change over time, but are fixed within an epoch.
Consider a single deme that suffered a bottleneck 50 generations ago.</p>
<p>{{ example.replace(“LABEL”, “04”).replace(“%DRAWING_TAG”, “:selected:”) }}</p>
<p>To specify the change in the population size, we’ve introduced a second epoch
into the YAML file.
We now need three time values to define the epoch boundaries:
the <code class="docutils literal notranslate"><span class="pre">start_time</span></code> of the deme, the <code class="docutils literal notranslate"><span class="pre">end_time</span></code> of epoch 0,
and the <code class="docutils literal notranslate"><span class="pre">end_time</span></code> of epoch 1. All epochs must be listed in time-descending
order (from the past towards the present).</p>
<p>The same model can be written using default values for the deme’s
<code class="docutils literal notranslate"><span class="pre">start_time</span></code> and the final epoch’s <code class="docutils literal notranslate"><span class="pre">end_time</span></code>.</p>
<p>{{ example.replace(“LABEL”, “05”) }}</p>
<div class="section" id="why-don-t-epochs-have-a-start-time-too">
<h3>Why don’t epochs have a <code class="docutils literal notranslate"><span class="pre">start_time</span></code> too?<a class="headerlink" href="#why-don-t-epochs-have-a-start-time-too" title="Permalink to this headline">¶</a></h3>
<p>The start time of an epoch can be inferred indirectly, by looking at the
deme’s <code class="docutils literal notranslate"><span class="pre">start_time</span></code> (for epoch 0), or by looking at the previous epoch’s
<code class="docutils literal notranslate"><span class="pre">end_time</span></code> (for epoch 1, 2, etc.).</p>
</div>
</div>
<div class="section" id="exponential-size-changes">
<h2>Exponential size changes<a class="headerlink" href="#exponential-size-changes" title="Permalink to this headline">¶</a></h2>
<p>In the previous model, the population size was constant in each epoch.
But what if we wanted to model a period of exponential population size growth,
or an exponential decay? In any given epoch, there are actually two
population size parameters, <code class="docutils literal notranslate"><span class="pre">start_size</span></code> and <code class="docutils literal notranslate"><span class="pre">end_size</span></code>, which correspond
to the size at the start and end of the epoch. If both parameters have the
same value, then the size is constant over the epoch.
However, If an epoch’s <code class="docutils literal notranslate"><span class="pre">start_size</span></code> and <code class="docutils literal notranslate"><span class="pre">end_size</span></code> properties are not equal,
then the epoch is defined to have an exponentially-changing population size
over the epoch’s time interval. Two important implications of this system are:</p>
<ul class="simple">
<li><p>We don’t need to specify a rate parameter for the exponential.
If this really is needed, it can be calculated from the <code class="docutils literal notranslate"><span class="pre">start_size</span></code>,
<code class="docutils literal notranslate"><span class="pre">end_size</span></code>, <code class="docutils literal notranslate"><span class="pre">start_time</span></code> and <code class="docutils literal notranslate"><span class="pre">end_time</span></code> values for an epoch.</p></li>
<li><p>Infinitely long epochs must have a constant population size.
So if a deme has an infinite <code class="docutils literal notranslate"><span class="pre">start_time</span></code>, then <code class="docutils literal notranslate"><span class="pre">start_size</span></code>
and <code class="docutils literal notranslate"><span class="pre">end_size</span></code> must be equal for epoch 0.</p></li>
</ul>
<p>To make these ideas more concrete, let’s look at an implementation of
the well-known ZigZag model from
<a class="reference external" href="https://doi.org/10.1038/ng.3015">Schiffels &amp; Durbin (2014)</a>.</p>
<p>{{ example.replace(“LABEL”, “06”) }}</p>
<p>We’ve introduced several new features to implement this model,
so let’s step through it from top to bottom.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">doi</span></code> property is a list of strings corresponding to the DOI(s)
for publication(s) in which the model was described. By convention,
the elements of the <code class="docutils literal notranslate"><span class="pre">doi</span></code> list are URLs, but any string value can be used.</p></li>
<li><p>A compact-form syntax is used for each epoch in the <code class="docutils literal notranslate"><span class="pre">epochs</span></code> list
(with curly braces <code class="docutils literal notranslate"><span class="pre">{</span></code> and <code class="docutils literal notranslate"><span class="pre">}</span></code>), rather than using multiple lines.
This is known as “flow style” in YAML parlance.</p></li>
<li><p>Epoch 0 has a <code class="docutils literal notranslate"><span class="pre">start_size</span></code>, but no <code class="docutils literal notranslate"><span class="pre">end_size</span></code>. Because this epoch has
an infinite time span, the population size must be constant, so the
epoch’s <code class="docutils literal notranslate"><span class="pre">end_size</span></code> will be the same as the <code class="docutils literal notranslate"><span class="pre">start_size</span></code>.</p></li>
<li><p>Epoch 1 has an <code class="docutils literal notranslate"><span class="pre">end_size</span></code>, but no <code class="docutils literal notranslate"><span class="pre">start_size</span></code>. So the <code class="docutils literal notranslate"><span class="pre">start_size</span></code>
is inherited from the <code class="docutils literal notranslate"><span class="pre">end_size</span></code> of the previous epoch.
This means the <code class="docutils literal notranslate"><span class="pre">end_size</span></code> and <code class="docutils literal notranslate"><span class="pre">start_size</span></code> for this epoch are different,
and there will be exponential population growth over the epoch.</p></li>
<li><p>Epochs 2 through 5 also inherit their <code class="docutils literal notranslate"><span class="pre">start_size</span></code> from the previous
epoch, and in each case these are different from the <code class="docutils literal notranslate"><span class="pre">end_size</span></code> provided.</p></li>
<li><p>Epochs 2 and 4 have exponential decay, whereas epochs 3 and 5 have
exponential growth.</p></li>
<li><p>The final epoch has a constant size.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Other modelling frameworks may use the terms “epoch” or “epochs” to refer to
time intervals that partition an entire model. However, in Demes,
epochs are a deme-specific property, and each deme has its own list
of epochs which do not apply to the other demes in the model.</p>
</div>
</div>
<div class="section" id="multiple-demes">
<h2>Multiple demes<a class="headerlink" href="#multiple-demes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="a-split-event">
<h3>A split event<a class="headerlink" href="#a-split-event" title="Permalink to this headline">¶</a></h3>
<p>Suppose we’re interested in modelling two demes, <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>.
The two demes are related by a common ancestor, from which they split
1000 generations ago. In addition to <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>, we’ll model their
common ancestor as an additional deme, <code class="docutils literal notranslate"><span class="pre">X</span></code>.
Here, we introduce the <code class="docutils literal notranslate"><span class="pre">ancestors</span></code> property of a deme,
which is a list of deme names.</p>
<p>{{ example.replace(“LABEL”, “07”) }}</p>
<p>When a deme has an ancestor, its <code class="docutils literal notranslate"><span class="pre">start_time</span></code> does <strong>not</strong> default to <code class="docutils literal notranslate"><span class="pre">.inf</span></code>.
In this case, the <code class="docutils literal notranslate"><span class="pre">start_time</span></code> for the deme is inherited from the
<code class="docutils literal notranslate"><span class="pre">end_time</span></code> of the ancestor.
I.e. for the model above, both <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> have a <code class="docutils literal notranslate"><span class="pre">start_time</span></code>
1000 generations ago.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A deme cannot appear in the demes list before its ancestor(s).
This means models must be written in a “top down” manner,
starting with the ancestral (root) deme(s), and followed
by increasingly recent demes.</p>
</div>
<p>By convention, we use a more compact form for the ancestors list.
Lists can be written more compactly with YAML “flow style”, which uses
square brackets (<code class="docutils literal notranslate"><span class="pre">[</span></code> and <code class="docutils literal notranslate"><span class="pre">]</span></code>, with a comma separating list items).
The following Demes file describes an equivalent model.</p>
<p>{{ example.replace(“LABEL”, “08”) }}</p>
</div>
<div class="section" id="a-branch-event">
<h3>A branch event<a class="headerlink" href="#a-branch-event" title="Permalink to this headline">¶</a></h3>
<p>An alternative way of modelling a population split is for the
ancestral deme to remain alive after the split. We will refer to this
as a <em>branch</em> event, rather than a split event.
In the model below, deme <code class="docutils literal notranslate"><span class="pre">A</span></code> has <code class="docutils literal notranslate"><span class="pre">X</span></code> as an ancestor like the previous model,
except here <code class="docutils literal notranslate"><span class="pre">X</span></code> continues to exist until 0 generations ago
(recall that 0 is the default value for the final epoch’s <code class="docutils literal notranslate"><span class="pre">end_time</span></code>).
Now that <code class="docutils literal notranslate"><span class="pre">A</span></code>’s ancestor exists until 0 generations ago we must
explicitly provide a <code class="docutils literal notranslate"><span class="pre">start_time</span></code> for <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p>{{ example.replace(“LABEL”, “09”) }}</p>
</div>
</div>
<div class="section" id="multiple-ancestors">
<h2>Multiple ancestors<a class="headerlink" href="#multiple-ancestors" title="Permalink to this headline">¶</a></h2>
<p>When a deme has multiple ancestors, these appear in the <code class="docutils literal notranslate"><span class="pre">ancestors</span></code> list
as one might expect. But for multiple ancestors we need to also specify the
proportion of ancestry inherited from each ancestor. This is done using
the deme’s <code class="docutils literal notranslate"><span class="pre">proportions</span></code> list property. The first proportion in the
<code class="docutils literal notranslate"><span class="pre">proportions</span></code> list is for the first ancestor in the <code class="docutils literal notranslate"><span class="pre">ancestors</span></code> list,
the second proportion is for the second ancestor, and so on.
Just like the case of a single ancestor, an ancestor can terminate at
the descendant’s <code class="docutils literal notranslate"><span class="pre">start_time</span></code>, or can instead continue to exist.</p>
<p>{{ example.replace(“LABEL”, “10”) }}</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>With multiple ancestors, the <code class="docutils literal notranslate"><span class="pre">start_time</span></code> of the descendant deme does not
default to the <code class="docutils literal notranslate"><span class="pre">end_time</span></code> of any of its ancestors. So the <code class="docutils literal notranslate"><span class="pre">start_time</span></code>
must always be specified for a deme with multiple ancestors.</p>
</div>
</div>
<div class="section" id="continuous-migration">
<h2>Continuous migration<a class="headerlink" href="#continuous-migration" title="Permalink to this headline">¶</a></h2>
<p>Let’s again consider a model with demes <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>, which are related
via a common ancestor <code class="docutils literal notranslate"><span class="pre">X</span></code> (a split event).</p>
<div class="section" id="asymmetric-migration">
<h3>Asymmetric migration<a class="headerlink" href="#asymmetric-migration" title="Permalink to this headline">¶</a></h3>
<p>To define continuous migration from <code class="docutils literal notranslate"><span class="pre">A</span></code> to <code class="docutils literal notranslate"><span class="pre">B</span></code>, we’ll add an entry to the
<code class="docutils literal notranslate"><span class="pre">migrations</span></code> list.
Concretely, we are modelling migrants born in deme <code class="docutils literal notranslate"><span class="pre">A</span></code>, the <code class="docutils literal notranslate"><span class="pre">source</span></code> deme,
who (potentially) have offspring in deme <code class="docutils literal notranslate"><span class="pre">B</span></code>, the <code class="docutils literal notranslate"><span class="pre">dest</span></code> deme.</p>
<p>{{ example.replace(“LABEL”, “11”) }}</p>
<p>The migrations here occur at a <code class="docutils literal notranslate"><span class="pre">rate</span></code> of <code class="docutils literal notranslate"><span class="pre">1e-4</span></code> per generation,
and occur continuously over the lifetime of both <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Migration rate units are always “per generation” regardless of
the chosen value for <code class="docutils literal notranslate"><span class="pre">time_units</span></code> (described later).</p>
</div>
<p>In the example above, <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> have identical existence time intervals.
If the <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">dest</span></code> demes do not have identical start
or end times, then by default the migration will occur over
the period of time when both demes exist simultaneously.</p>
<p>{{ example.replace(“LABEL”, “12”) }}</p>
<p>To obtain greater control over when migrations occur,
we can use the <code class="docutils literal notranslate"><span class="pre">start_time</span></code> and <code class="docutils literal notranslate"><span class="pre">end_time</span></code> migration properties.
Below we model three periods of continuous migration.</p>
<p>{{ example.replace(“LABEL”, “13”) }}</p>
<div class="question admonition">
<p class="admonition-title">Question</p>
<p>What do you think will happen if we list two or more migrations with
time intervals that overlap? Does it matter if the <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">dest</span></code>
demes are the same in each case?</p>
</div>
<div class="dropdown answer admonition">
<p class="admonition-title">Answer</p>
<p>Overlapping migrations are allowed in general.
But because it’s not clear what the expected behaviour should be when
overlapping migrations are defined with the same <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">dest</span></code>,
it’s an error to define such migrations.</p>
</div>
</div>
<div class="section" id="symmetric-migration">
<h3>Symmetric migration<a class="headerlink" href="#symmetric-migration" title="Permalink to this headline">¶</a></h3>
<p>It’s common to model migrants in both directions simultaneously,
with the same <code class="docutils literal notranslate"><span class="pre">rate</span></code>. We could use multiple asymmetric migrations,
but it’s simpler to specify a list of deme names (the migration’s
<code class="docutils literal notranslate"><span class="pre">demes</span></code> property), instead of a <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">dest</span></code>.</p>
<p>{{ example.replace(“LABEL”, “14”) }}</p>
<p>The <code class="docutils literal notranslate"><span class="pre">demes</span></code> property can list arbitrarily many demes. For example,
we could define symmetric migration between all pairwise combinations
of four demes.</p>
<p>{{ example.replace(“LABEL”, “15”) }}</p>
<p>When the following three conditions are satisfied:</p>
<ul class="simple">
<li><p>a symmetric migration is defined between more than two demes,</p></li>
<li><p>and the demes’ start and/or end times are not all identical,</p></li>
<li><p>and the migration’s <code class="docutils literal notranslate"><span class="pre">start_time</span></code> and/or <code class="docutils literal notranslate"><span class="pre">end_time</span></code> are omitted,</p></li>
</ul>
<p>then the time intervals for the migration are resolved separately for
each pair of participating demes. E.g. for the model below, migration
between <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> occurs at all times because both <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>
exist for all time. However, migrations between <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code>, and between
<code class="docutils literal notranslate"><span class="pre">B</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code>, are limited to the period of time after 100 generations ago,
because <code class="docutils literal notranslate"><span class="pre">C</span></code> does not exist before then.</p>
<p>{{ example.replace(“LABEL”, “16”) }}</p>
</div>
</div>
<div class="section" id="a-pulse-of-admixture">
<h2>A pulse of admixture<a class="headerlink" href="#a-pulse-of-admixture" title="Permalink to this headline">¶</a></h2>
<p>To model migration that is limited to a very short period of time,
we can define one or more <code class="docutils literal notranslate"><span class="pre">pulses</span></code>.
The <code class="docutils literal notranslate"><span class="pre">proportion</span></code> property of a pulse defines the proportion of the <code class="docutils literal notranslate"><span class="pre">dest</span></code>
deme that is made up of ancestry from the <code class="docutils literal notranslate"><span class="pre">source</span></code> deme at the instant after
the pulse’s <code class="docutils literal notranslate"><span class="pre">time</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The exact duration of a pulse is not defined by the Demes specification.
Software which implements a continuous-time model
(such as a coalescent simulator)
might treat a pulse as occurring instantaneously.
In contrast, software which implements a discrete-time model is free to treat
the pulse as occurring over a single time step (such as a single generation).</p>
</div>
<p>{{ example.replace(“LABEL”, “17”) }}</p>
<div class="exercise admonition">
<p class="admonition-title">Excercise</p>
<p>The <code class="docutils literal notranslate"><span class="pre">dest</span></code> deme in an admixture pulse could instead be modelled using
multiple ancestors.
Try doing this for deme <code class="docutils literal notranslate"><span class="pre">B</span></code> in the model above. What do you think are
the advantages of one approach over the other?</p>
</div>
<div class="question admonition">
<p class="admonition-title">Question</p>
<p>How should one interpret multiple pulses that occur at the same <code class="docutils literal notranslate"><span class="pre">time</span></code>?
Does it matter whether the <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">dest</span></code> demes are the same in
each pulse?</p>
</div>
<div class="dropdown answer admonition">
<p class="admonition-title">Answer</p>
<p>When multiple pulses are specified with the same <code class="docutils literal notranslate"><span class="pre">time</span></code>,
the migration pulses occur in the order in which they are written.
Consider the following two pulses into deme <code class="docutils literal notranslate"><span class="pre">A</span></code> at time 100.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">pulses</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">B</span>
  <span class="nt">dest</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">A</span>
  <span class="nt">time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
  <span class="nt">proportion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.1</span>
<span class="p p-Indicator">-</span> <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">C</span>
  <span class="nt">dest</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">A</span>
  <span class="nt">time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
  <span class="nt">proportion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.2</span>
</pre></div>
</div>
<p>The second pulse replaces 20% of <code class="docutils literal notranslate"><span class="pre">A</span></code>’s ancestry, including 20% of the ancestry
that was inherited from <code class="docutils literal notranslate"><span class="pre">B</span></code> in the first pulse.
So immediately after time 100, <code class="docutils literal notranslate"><span class="pre">A</span></code> has 20% ancestry from <code class="docutils literal notranslate"><span class="pre">C</span></code> but only 8%
ancestry from <code class="docutils literal notranslate"><span class="pre">B</span></code>.
As this may be confusing, we recommend avoiding the use of multiple pulses
in this way, and instead implement the model using multiple ancestors with
the desired final ancestry proportions.</p>
</div>
</div>
<div class="section" id="setting-defaults">
<h2>Setting defaults<a class="headerlink" href="#setting-defaults" title="Permalink to this headline">¶</a></h2>
<p>To avoid duplication in a Demes graph with many features, it’s possible
to set default values for some properties. Suppose we wish to define
multiple demes, each with only one epoch, and each with a constant
population size.</p>
<p>{{ example.replace(“LABEL”, “18”) }}</p>
<p>The epoch defaults can be overriden by providing an explicit value inside
the desired epoch.</p>
<p>{{ example.replace(“LABEL”, “19”) }}</p>
<p>It’s also possible to provide defaults for properties of a deme,
such as the <code class="docutils literal notranslate"><span class="pre">start_time</span></code> and <code class="docutils literal notranslate"><span class="pre">ancestors</span></code>.</p>
<p>{{ example.replace(“LABEL”, “20”) }}</p>
<div class="question admonition">
<p class="admonition-title">Question</p>
<p>How would the model be interpreted if we failed to override the <code class="docutils literal notranslate"><span class="pre">start_time</span></code>
and <code class="docutils literal notranslate"><span class="pre">ancestors</span></code> deme defaults for deme <code class="docutils literal notranslate"><span class="pre">X</span></code>?</p>
</div>
<div class="dropdown answer admonition">
<p class="admonition-title">Answer</p>
<p>If we didn’t override the default <code class="docutils literal notranslate"><span class="pre">start_time</span></code>, then <code class="docutils literal notranslate"><span class="pre">X</span></code> would have
both a <code class="docutils literal notranslate"><span class="pre">start_time</span></code> and <code class="docutils literal notranslate"><span class="pre">end_time</span></code> of 1000. This would be invalid,
because (a) there would be no deme with an infinite <code class="docutils literal notranslate"><span class="pre">start_time</span></code>,
and (b) the time span over which <code class="docutils literal notranslate"><span class="pre">X</span></code> existed would be zero.</p>
<p>If we didn’t override the default <code class="docutils literal notranslate"><span class="pre">ancestors</span></code> list, then <code class="docutils literal notranslate"><span class="pre">X</span></code> would
be in its own <code class="docutils literal notranslate"><span class="pre">ancestors</span></code> list. This would be invalid, because each ancestor
in the <code class="docutils literal notranslate"><span class="pre">ancestors</span></code> list must already be defined (earlier in the <code class="docutils literal notranslate"><span class="pre">demes</span></code> list).
This requirement has the pleasant side-effect that the directed graph of
ancestor/descendant relations cannot have cycles.
Alas, it is not possible to model time travel using Demes.</p>
</div>
<p>Defaults for <code class="docutils literal notranslate"><span class="pre">migration</span></code> and <code class="docutils literal notranslate"><span class="pre">pulse</span></code> objects may also be specified for
elements of the <code class="docutils literal notranslate"><span class="pre">migrations</span></code> and <code class="docutils literal notranslate"><span class="pre">pulses</span></code> lists.</p>
</div>
<div class="section" id="time-units-and-generation-time">
<h2>Time units and generation time<a class="headerlink" href="#time-units-and-generation-time" title="Permalink to this headline">¶</a></h2>
<p>In the previous examples, we’ve exclusively set <code class="docutils literal notranslate"><span class="pre">time_units</span></code> to “generations”.
This is appropriate in many cases, but sometimes other units are preferred.
For example, it’s sometimes more natural to describe times using <em>years</em>,
or even <em>thousands of years</em>. However, most simulation software operates
using generations as the canonical unit of time. In Demes, the <code class="docutils literal notranslate"><span class="pre">time_units</span></code>
property may be any string, but “generations” is special. If the <code class="docutils literal notranslate"><span class="pre">time_units</span></code>
are <strong>not</strong> “generations”, then an additional <code class="docutils literal notranslate"><span class="pre">generation_time</span></code> property must
be specified. This latter property can then be used by the simulator to
convert from the chosen <code class="docutils literal notranslate"><span class="pre">time_units</span></code> into units of generations.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The units for the <code class="docutils literal notranslate"><span class="pre">rate</span></code> of <code class="docutils literal notranslate"><span class="pre">migrations</span></code> are always per generation,
even when the <code class="docutils literal notranslate"><span class="pre">time_units</span></code> are not generations.
Only the various <code class="docutils literal notranslate"><span class="pre">start_time</span></code>, <code class="docutils literal notranslate"><span class="pre">end_time</span></code>, and <code class="docutils literal notranslate"><span class="pre">time</span></code> properties should
match the <code class="docutils literal notranslate"><span class="pre">time_units</span></code>.</p>
</div>
<p>{{ example.replace(“LABEL”, “21”) }}</p>
</div>
<div class="section" id="selfing-and-cloning">
<h2>Selfing and cloning<a class="headerlink" href="#selfing-and-cloning" title="Permalink to this headline">¶</a></h2>
<p>Epochs also have <code class="docutils literal notranslate"><span class="pre">selfing_rate</span></code> and <code class="docutils literal notranslate"><span class="pre">cloning_rate</span></code> properties,
which default to 0 if not specified.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Give examples.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="introduction.html" title="previous page">Introduction</a>
    <a class='right-next' id="next-link" href="gallery.html" title="next page">Gallery</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By PopSim Consortium<br/>
        
            &copy; Copyright 2021.<br/>
          <div class="extra_footer">
            demes-spec 0.9
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>